{
  "Version": "2019-10-30",
  "StartAction": "f7c9b764-4f40-4b81-8176-e15914875b4a",
  "Metadata": {
    "entryPointPosition": {
      "x": -440,
      "y": -20
    },
    "ActionMetadata": {
      "ead55375-e379-4af5-80bc-527d04131fcc": {
        "position": {
          "x": 0,
          "y": 0
        }
      },
      "f7c9b764-4f40-4b81-8176-e15914875b4a": {
        "position": {
          "x": -280,
          "y": 0
        }
      },
      "3e05fb47-2100-4410-a333-26e12f30429d": {
        "position": {
          "x": 1120,
          "y": 0
        }
      },
      "50b6aab8-40d8-4751-8a14-8f3df571d145": {
        "position": {
          "x": 1680,
          "y": 0
        },
        "parameters": {
          "ContactFlowId": {
            "displayName": "Sample inbound flow (first contact experience)"
          }
        },
        "ContactFlow": {
          "text": "Sample inbound flow (first contact experience)"
        }
      },
      "7670fbff-a8d2-451b-ae8f-546c90e92554": {
        "position": {
          "x": 1960,
          "y": 0
        }
      },
      "401a0775-88b3-457f-b9e6-f92f13348853": {
        "position": {
          "x": 2240,
          "y": 0
        }
      },
      "4b7ebbdb-22ed-4cfd-b566-8285daa53cbc": {
        "position": {
          "x": 280,
          "y": 0
        },
        "conditionMetadata": [],
        "countryCodePrefix": "+1"
      },
      "47807027-2b2b-4a3f-bb4f-a9a53e020ec2": {
        "position": {
          "x": 560,
          "y": 0
        },
        "parameters": {
          "LambdaFunctionARN": {
            "displayName": "connect-encryption"
          },
          "LambdaInvocationAttributes": {
            "my-secret-string": {
              "useDynamic": true
            }
          }
        },
        "dynamicMetadata": {
          "my-secret-string": true,
          "key-id": false
        }
      },
      "bbe6e7de-5c19-4a58-bb9f-a5dc960faaf7": {
        "position": {
          "x": 840,
          "y": 0
        },
        "conditionMetadata": [
          {
            "id": "0e0a4184-55ca-43d3-b560-deae929febbe",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "200"
          }
        ]
      },
      "5f924f08-6a62-4850-80a3-c24a00cc49f1": {
        "position": {
          "x": 1400,
          "y": 0
        }
      },
      "e1d99e8e-e457-491b-af02-53d70d90580f": {
        "position": {
          "x": 1120,
          "y": 260
        }
      }
    },
    "Annotations": [],
    "name": "Sample secure input with no agent",
    "description": "Enables the customer to enter digits in private. In a real world implementation, enabling encryption is likely preferred.",
    "type": "contactFlow",
    "status": "published",
    "hash": {}
  },
  "Actions": [
    {
      "Parameters": {
        "Text": "This flow enables users to enter information secured by an encryption key you provide."
      },
      "Identifier": "ead55375-e379-4af5-80bc-527d04131fcc",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "4b7ebbdb-22ed-4cfd-b566-8285daa53cbc"
      }
    },
    {
      "Parameters": {
        "FlowLoggingBehavior": "Enabled"
      },
      "Identifier": "f7c9b764-4f40-4b81-8176-e15914875b4a",
      "Type": "UpdateFlowLoggingBehavior",
      "Transitions": {
        "NextAction": "ead55375-e379-4af5-80bc-527d04131fcc"
      }
    },
    {
      "Parameters": {
        "Text": "The encrypted customer credit card number is now saved and can be passed to the agent as a screenpop or processed using AWS Lambda. You may also want to check out the sample secure input flow with an agent."
      },
      "Identifier": "3e05fb47-2100-4410-a333-26e12f30429d",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "5f924f08-6a62-4850-80a3-c24a00cc49f1"
      }
    },
    {
      "Parameters": {
        "ContactFlowId": "arn:aws:connect:eu-west-2:111122223333:instance/695202c7-24bb-469b-be44-7a0bf91dfd94/contact-flow/48f1a365-bf3e-41dd-8cf9-cb7cb310cddd"
      },
      "Identifier": "50b6aab8-40d8-4751-8a14-8f3df571d145",
      "Type": "TransferToFlow",
      "Transitions": {
        "NextAction": "7670fbff-a8d2-451b-ae8f-546c90e92554",
        "Errors": [
          {
            "NextAction": "7670fbff-a8d2-451b-ae8f-546c90e92554",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Text": "We are unable to return back to the flow. Goodbye."
      },
      "Identifier": "7670fbff-a8d2-451b-ae8f-546c90e92554",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "401a0775-88b3-457f-b9e6-f92f13348853"
      }
    },
    {
      "Parameters": {},
      "Identifier": "401a0775-88b3-457f-b9e6-f92f13348853",
      "Type": "DisconnectParticipant",
      "Transitions": {}
    },
    {
      "Parameters": {
        "StoreInput": "True",
        "InputTimeLimitSeconds": "6",
        "Text": "Please enter your credit card number, press the pound key when complete.",
        "DTMFConfiguration": {
          "DisableCancelKey": "False",
          "InterdigitTimeLimitSeconds": "5"
        },
        "InputValidation": {
          "CustomValidation": {
            "MaximumLength": "16"
          }
        },
        "InputEncryption": {
          "EncryptionKeyId": "b1071b33-0944-47f3-945c-098f3725ac1d",
          "Key": "-----BEGIN CERTIFICATE-----\nMIIDcDCCAlgCCQDi2m+Ae17ssDANBgkqhkiG9w0BAQsFADB6MQswCQYDVQQGEwJV\nSzEQMA4GA1UECAwHRW5nbGFuZDEPMA0GA1UEBwwGTG9uZG9uMRcwFQYDVQQKDA5N\neU9yZ2FuaXphdGlvbjELMAkGA1UECwwCSVQxIjAgBgNVBAMMGWFtYXpvbi1jb25u\nZWN0LWVuY3J5cHRpb24wHhcNMjUwOTI4MDkyNzE4WhcNMjYwOTI4MDkyNzE4WjB6\nMQswCQYDVQQGEwJVSzEQMA4GA1UECAwHRW5nbGFuZDEPMA0GA1UEBwwGTG9uZG9u\nMRcwFQYDVQQKDA5NeU9yZ2FuaXphdGlvbjELMAkGA1UECwwCSVQxIjAgBgNVBAMM\nGWFtYXpvbi1jb25uZWN0LWVuY3J5cHRpb24wggEiMA0GCSqGSIb3DQEBAQUAA4IB\nDwAwggEKAoIBAQDHOoM7F3cVFWoFGH4l+DR9QR7r+u4374QX87X7A9cQBqwtOdkH\nssw2a+xZBK86Ke78cVmpKhcoRjZQC7D6EP8egDk30Eis6E/WBS33H5ck1X8MDzE9\nlahIHzDt1we0csRCbdq1+yEAPLenD1n4Ix5FoYTEcYYnHblNFQ4fZ+l0CHTX0A3m\ndmtwaPM2a/jjr1P6U4p/Dpw+Qt6Sy8lY3a6zkyBdl1YB7TZ4IUxGtOHKPJGvMYhz\nrN0yZd+nJgVmVY+OvxHuqT1rOHSmV2Um0KCkdJrZ9pO0++ohe4ltsoZ7mAuLMiZ9\n+rIxagx1CrFek3v3ni57RHShIVJettOl6jKrAgMBAAEwDQYJKoZIhvcNAQELBQAD\nggEBAJMIyneqm8d89ZIRgvj1EYKAiYEUZoFjfqlnkAj2MV8g6dXFq8/oeVxT21fM\nVcvDsIZlpt0CWSElSYzr6EnoErhpBjelx72UNJzxD7yhfaorVpU90J6Ygmc46fjt\nwPIfppDIGuSGzNqIxniDTTkUdqJiwCA31uzyYbKwKfihdlLDkrf0imoSMPvVlDPh\n4FsVKCSaZX/dK/VLAyca9r4udV0yRetaKRymq3nM8GS6DNBhSXGfra37OSY47/WH\nuWH2lJK+FXbUa/BVNOvd1Np9r1CSpbfyXUrF2UwVfJCwjrN8gCAxovZkGfYRFCKL\nNOPC8nX/pJdXauLZh1F+sm0+gxg=\n-----END CERTIFICATE-----"
        }
      },
      "Identifier": "4b7ebbdb-22ed-4cfd-b566-8285daa53cbc",
      "Type": "GetParticipantInput",
      "Transitions": {
        "NextAction": "47807027-2b2b-4a3f-bb4f-a9a53e020ec2",
        "Errors": [
          {
            "NextAction": "e1d99e8e-e457-491b-af02-53d70d90580f",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "LambdaFunctionARN": "arn:aws:lambda:eu-west-2:111122223333:function:connect-encryption",
        "InvocationTimeLimitSeconds": "8",
        "InvocationType": "SYNCHRONOUS",
        "LambdaInvocationAttributes": {
          "my-secret-string": "$.StoredCustomerInput",
          "key-id": "<enter-key-id>"
        },
        "ResponseValidation": {
          "ResponseType": "JSON"
        }
      },
      "Identifier": "47807027-2b2b-4a3f-bb4f-a9a53e020ec2",
      "Type": "InvokeLambdaFunction",
      "Transitions": {
        "NextAction": "bbe6e7de-5c19-4a58-bb9f-a5dc960faaf7",
        "Errors": [
          {
            "NextAction": "e1d99e8e-e457-491b-af02-53d70d90580f",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "ComparisonValue": "$.External.status-code"
      },
      "Identifier": "bbe6e7de-5c19-4a58-bb9f-a5dc960faaf7",
      "Type": "Compare",
      "Transitions": {
        "NextAction": "e1d99e8e-e457-491b-af02-53d70d90580f",
        "Conditions": [
          {
            "NextAction": "3e05fb47-2100-4410-a333-26e12f30429d",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "200"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "e1d99e8e-e457-491b-af02-53d70d90580f",
            "ErrorType": "NoMatchingCondition"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Text": "Returning back to the original flow."
      },
      "Identifier": "5f924f08-6a62-4850-80a3-c24a00cc49f1",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "50b6aab8-40d8-4751-8a14-8f3df571d145"
      }
    },
    {
      "Parameters": {
        "Text": "There was a problem gathering the customer's input. Did you specify an encryption key in the Store customer input block?"
      },
      "Identifier": "e1d99e8e-e457-491b-af02-53d70d90580f",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "5f924f08-6a62-4850-80a3-c24a00cc49f1"
      }
    }
  ]
}